{% extends 'index_parent.html' %}
{% load static %}
{% block subject %}
<img class="img-fluid m-auto img-thumbnail" src="{{theme.img_path}}" alt="Image Description" style="width:230; height:320; position:;">
{% endblock %}
{% block subject2 %}
<label class="form-label text-black fw-bolder">{{theme.theme}}</label>
{% endblock %}
{% block main %}
<main>
<div class="container-fluid px-5">  
    <!-- Listing - Main Info -->
    <div class="row my-1">
      <div class="col-md-4 col-lg-3 g-mb-30">
      </div>
      <div class="col-md-4 col-lg-6 g-mb-30">
        <div class="row my-1">
        <div class="col-md-4 col-lg-12 g-mb-30">
          <i class = "bi-info-circle-fill me-1"></i>
            <label for="list" class="h5 form-label fw-bolder mt-3">테마 정보</label>
          <div class="row">
            <!-- Listing - List of Details -->
            <ul class="col-md-6 list-unstyled mb-0">     
            <li class="border-top-0 border-end-0 border-start-0 border-0.1 pt-1 mb-3" style="border : 1px dashed gray;">
                <span class="float">지점 :</span>
                <span class="float" style="float:right;">{{room}}</span>
            </li>
            <li class="border-top-0 border-end-0 border-start-0 border-0.1 pt-1 mb-3" style="border : 1px dashed gray;">
              <span class="float">장르 :</span>
              <span class="float" style="float:right;">{{theme.genre}}</span>
            </li>
            <li class="border-top-0 border-end-0 border-start-0 border-0.1 pt-1 mb-3" style="border : 1px dashed gray;">
              <span class="float">공포도 :</span>
              <span class="float" style="float:right;">{{theme.horror}}</span>
            </li>
            <li class="border-top-0 border-end-0 border-start-0 border-0.1 pt-1 mb-3" style="border : 1px dashed gray;">
              <span class="float">난이도 :</span>
              <span class="float" style="float:right;">{{theme.difficulty}}</span>
            </li>
            <li class="border-top-0 border-end-0 border-start-0 border-0.1 pt-1 mb-3" style="border : 1px dashed gray;">
              <span class="float">활동성 :</span>
              <span class="float" style="float:right;">{{theme.activity}}</span>
            </li>
            <li class="border-top-0 border-end-0 border-start-0 border-0.1 pt-1 mb-3" style="border : 1px dashed gray;">
              <span class="float">평점 :</span>
              <span class="float" style="float:right;">{{theme.star}}</span>
            </li>
          </ul>
          <ul class="col-md-6 list-unstyled mb-0">     
            <li class="border-top-0 border-end-0 border-start-0 border-0.1 pt-1 mb-3" style="border : 1px dashed gray;">
                <span class="float">테마 소개 :</span>
                <span class="float" style="float:right;">{{theme.info}}</span>
            </li>
          </ul>
            <!-- End Listing - List of Details -->
    
            <!-- Listing - List of Details -->

        <div class="col-md-4 col-lg-12 g-mb-30 border border-1 border-start-0 border-end-0 pt-4">
          <!-- Listing - Location on Map -->
          <i class = "bi-map-fill me-1"></i>
          <label for="map" class="h5 form-label fw-bolder">위치(지도)</label>
            <div class="col-md-10 g-mb-30 mb-3 border border-4" style="float:none; margin:auto;">
              <body>
                <!-- 지도를 표시할 div 입니다 -->
                <div id="map" style="width:100%;height:350px;"></div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=8b4886b8828a4c3060dc36cf1ef9b61c&libraries=services,clusterer,drawing"></script>
<script>
var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
    mapOption = {
        center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
        level: 3 // 지도의 확대 레벨
    };  

// 지도를 생성합니다    
var map = new kakao.maps.Map(mapContainer, mapOption); 

// 주소-좌표 변환 객체를 생성합니다
var geocoder = new kakao.maps.services.Geocoder();

// 주소로 좌표를 검색합니다
geocoder.addressSearch("{{loc}}", function(result, status) {

    // 정상적으로 검색이 완료됐으면 
     if (status === kakao.maps.services.Status.OK) {

        var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

        // 결과값으로 받은 위치를 마커로 표시합니다
        var marker = new kakao.maps.Marker({
            map: map,
            position: coords
        });
        // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
        map.setCenter(coords);
    }else{
      geocoder.addressSearch("{{room}}", function(result, status) {

        // 정상적으로 검색이 완료됐으면 
         if (status === kakao.maps.services.Status.OK) {
    
            var coords = new kakao.maps.LatLng(result[0].y, result[0].x);
    
            // 결과값으로 받은 위치를 마커로 표시합니다
            var marker = new kakao.maps.Marker({
                map: map,
                position: coords
            });
            // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
            map.setCenter(coords);
        }else{
          alert("{{room}}")
        }
    });   
    }
});    
</script>
                </body>
            </div>
        </div>
        <div class="col-md-4 col-lg-12 g-mb-30 my-4">
          <i class = "bi-door-open-fill me-1"></i>
        <label for="review" class="h5 form-label fw-bolder">리뷰</label>
            <div class="row bg-light border border-1 rounded-1 ms-1">
              
              <form name="theme_review_form" action="/theme/theme_detail/{{theme.no}}" method="post">
                {% csrf_token %}
                <div class="input-group m-1">
                  <label for="title" class="form-label pt-1 fw-bolder me-3">제목 :</label>
                  <input type="text" name="theme_review_title" id="title" value="" class="form-control rounded-1 form-control-sm" style="max-width:500px">
                </div>
                      <div class="input-group mb-2">
                        <textarea name="theme_review_contents" class="text text-break text-wrap form-control rounded-1 form-control-sm" style="min-height:100px" id="contents" name="contents"  rows="15" cols="70"></textarea>
                      </div>
                      <div class="row">
                      <div class="col-md-9 g-mb-30 col-lg-3" style="text-align:center">
                        <label for="fear" class="form-label m-0 fw-bold">공포도</label>
                              <li class="list-unstyled fear">
                                <i data-value="1" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="2" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="3" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="4" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="5" class="bi-star" onclick='click_star(this)'></i>
                              </li>
                      </div>
                      <div class="col-md-9 g-mb-30 col-lg-3" style="text-align:center">
                        <label for="activeness" class="form-label m-0 fw-bold">활동성</label>
                              <li class="list-unstyled activeness">
                                <i data-value="1" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="2" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="3" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="4" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="5" class="bi-star" onclick='click_star(this)'></i>
                              </li>
                      </div>
                      <div class="col-md-9 g-mb-30 col-lg-3" style="text-align:center">
                        <label for="difficulty" class="form-label m-0 fw-bold">난이도</label>
                              <li class="list-unstyled difficulty">
                                <i data-value="1" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="2" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="3" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="4" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="5" class="bi-star" onclick='click_star(this)'></i>
                              </li>
                      </div>
                      <div class="col-md-9 g-mb-30 col-lg-3" style="text-align:center">
                        <label for="score" class="form-label m-0 fw-bold">평점</label>
                              <li class="list-unstyled score">
                                <i data-value="1" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="2" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="3" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="4" class="bi-star" onclick='click_star(this)'></i>
                                <i data-value="5" class="bi-star" onclick='click_star(this)'></i>
                              </li>      
                      </div>
                    </div>
                      <span class="input-group-btn">
                        {% if request.session.member_id %}
                        <button class="btn btn-sm bg-warning rounded-2 text-white fw-bold float-end my-2" type="submit">확인</button>
                        {% else %}
                        <button class="btn btn-sm bg-warning rounded-2 text-white fw-bold float-end my-2" onclick="alert('로그인을 해주세요')" href="../" type="submit">확인</button>
                        {% endif %}
                      </span>
                </div>
              </form>
              <div class="row ms-1">
                <table class="table table-hover u-table--v1 mt-3 text-center">
                  <thead>
                    <tr><th width="35%" class="text-center">제목</th>
                      <th width="20%" class="text-center">별점</th>
                      <th width="20%" class="text-center">닉네임</th>
                      <th width="25%" class="text-center">작성일자</th>
                  </tr></thead>
                  {% for x, y in zipped %}
                  <tbody class="reviews table-hover">
                    <tr>
                      <td class="g-font-size-12 text-center" onclick="location.href='/reviews/868'">{{x.title}}</td>
                      <td class="g-font-size-12 text-center">
                        <div class="col-lg-10 p-0 mt-1">
                          <li class="list-unstyled score" style = "position:absolute;">
                            <i value="1" class="bi-star"></i>
                            <i value="2" class="bi-star"></i>
                            <i value="3" class="bi-star"></i>
                            <i value="4" class="bi-star"></i>
                            <i value="5" class="bi-star"></i>
                        </li>
                        <li class="list-unstyled score_fill" value="" style ="max-width:{{x.stars}}px; overflow:hidden; white-space:nowrap;">
                            <i value="1" class="bi-star-fill"></i>
                            <i value="2" class="bi-star-fill"></i>
                            <i value="3" class="bi-star-fill"></i>
                            <i value="4" class="bi-star-fill"></i>
                            <i value="5" class="bi-star-fill"></i>
                        </li>
                      </div>
                      </td>
                      <td class="g-font-size-12 text-center" onclick="location.href='/user/친저란'">{{y}}</td>
                      <td class="g-font-size-12 text-center" onclick="location.href='/reviews/868'">{{x.rdate}}</td>
                    </tr>
                  </tbody>
                  {% endfor %}
                </table>   
        <nav>
          <ul class="pagination justify-content-center">
            <li class="page-item active">
              <a rel="prev" class="page-link" href="/caves/1">1</a>
            </li>
            <li class="page-item">
              <a data-remote="false" class="page-link">2</a>
            </li>
          </ul>
        </nav>
      </div>
                
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- End Call to Action -->
    
      
</div>
    </main>
{% endblock %}